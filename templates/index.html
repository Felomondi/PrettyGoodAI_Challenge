{% extends "base.html" %}
{% block title %}Voice Bot — PrettyGoodAI{% endblock %}

{% block content %}
<div class="card wide">

  {% if patient %}
  <div class="index-header">
    <div>
      <h1>Ready to Simulate</h1>
      <p class="subtitle">
        Calls go to <strong>+1-805-439-8008</strong> as the patient below.
      </p>
    </div>

    <div class="patient-card">
      <div class="patient-avatar">{{ patient.full_name[0] }}</div>
      <div class="patient-info">
        <div class="patient-name">{{ patient.full_name }}</div>
        <div class="patient-meta">{{ patient.phone }} &nbsp;·&nbsp; DOB {{ patient.dob }}</div>
      </div>
    </div>
  </div>

  <div class="scenarios-toolbar">
    <span class="scenarios-label">{{ scenarios | length }} scenarios</span>
    <form method="POST" action="/simulate">
      <button type="submit" class="btn btn-simulate-all">Run All Scenarios</button>
    </form>
  </div>

  <table class="scenarios-table">
    <thead>
      <tr>
        <th>#</th>
        <th>Scenario</th>
        <th>Type</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      {% for s in scenarios %}
      <tr>
        <td class="col-num">{{ loop.index }}</td>
        <td class="col-name">{{ s.name }}</td>
        <td><span class="tag tag-{{ s.edge_case_type }}">{{ s.edge_case_type }}</span></td>
        <td class="col-action">
          <form method="POST" action="/simulate/{{ s.id }}">
            <button type="submit" class="btn-run">Run</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p class="change-patient">
    Wrong patient? <a href="/register">Register a different one</a>
    or <a href="/patients">manage patients</a>.
  </p>

  {% else %}
  <h1>No Patient Registered</h1>
  <p class="subtitle">
    Register a patient first. The bot will call as that patient identity.
  </p>
  <a href="/register" class="btn">Register Patient</a>
  {% endif %}

</div>
{% endblock %}
